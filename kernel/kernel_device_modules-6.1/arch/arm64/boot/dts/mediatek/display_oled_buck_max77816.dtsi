/*
 * Samsung Exynos SoC series Panel driver
 *
 * Copyright (c) 2020 Samsung Electronics Co., Ltd
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

&pio {
	buck_i2c_default: buck_i2c_default {
		samsung,pins = SEC_GPIO(AP,pio,64), SEC_GPIO(AP,pio,65);
		samsung,pin-function = <2>;
		samsung,pin-pud = <3>;
		samsung,pin-drv = <0>;
		samsung,pin-con-pdn = <3>;				// PREV in sleep
		samsung,pin-pud-pdn = <3>;				// PU
	};
};

&pio {
	buck_en_gpio_default: buck-en-gpio-default {
		samsung,pins = SEC_GPIO(AP,pio,86);
		samsung,pin-function = <1>;	// OUT
		samsung,pin-pud = <0>;		// NP
		samsung,pin-con-pdn = <3>;	// PREV in sleep
		samsung,pin-pud-pdn = <0>;	// NP in sleep
	};
};

&i2c12 {
	#address-cells = <1>;
	#size-cells = <0>;

	clock-frequency = <400000>;

	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <
		&buck_i2c_default
		&buck_en_gpio_default
	>;

	panel_drv_buck_i2c@0x18 {
		compatible = "panel_drv,i2c";
		reg = <0x18>;
		len,addr= <1>;
		len,data= <1>;
	};
};

/ {
	fragment@panel_drv {
		target-path = "/";
		__overlay__ {
			panel_drv_0: panel_drv_0 {
				blic = <&panel_blic>;
			};

			/* define regulator */
			max77816_regulator: max77816_regulator {
				regulator-name = "max77816_regulator";
				regulator-desc-name = "ddi-buck-booster";
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-boot-on;
			};

			panel_blic: panel_blic {
				max77816 {
					name = "max77816";
					i2c,reg = <0x18>;
					i2c,match = <0x00 0x00 0x00>; /* addr mask val */

					/* register regulator */
					regulator = <&max77816_regulator>;

					gpios {
						gpio_hwen: gpio_hwen {
							gpios = <SEC_GPIO_REF(AP,pio,86) 1>;
							dir = <0>;  /* OUT */
							irq-type = <0x0>;   /* NONE */
						};
					};

					power_ctrl {
						actions {
							max77816_gpio_hwen_on: max77816_gpio_hwen_on {
								type = <PCTRL_GPIO_ENABLE>;
								gpio = <&gpio_hwen>;
							};
							max77816_gpio_hwen_off: max77816_gpio_hwen_off {
								type = <PCTRL_GPIO_DISABLE>;
								gpio = <&gpio_hwen>;
							};
							max77816_delay_2ms: max77816_delay_2ms {
								type = <PCTRL_DELAY_MSLEEP>;
								value = <2>;
							};
						};

						sequences {
							panel_blic_pre_on = <&max77816_gpio_hwen_on &max77816_delay_2ms>;
							panel_blic_post_off = <&max77816_delay_2ms &max77816_gpio_hwen_off>;
						};
					};
				};
			};
		};
	};
};

